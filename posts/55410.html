<!DOCTYPE html><html lang="cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Mysql (二) | Daisy's Blog</title><meta name="author" content="Daisy"><meta name="copyright" content="Daisy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="存储函数MySQL存储函数（自定义函数），函数一般用于计算和返回一个值，可以将经常需要使用的计算或功能写成一个函数。 存储函数和存储过程一样，都是在数据库中定义一些 SQL 语句的集合。 存储函数与存储过程的区别  存储函数有且只有一个返回值，而存储过程可以有多个返回值，也可以没有返回值 存储函数只"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://starskydata.com/posts/55410.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="sDPUs3nTAhgMGYrvOmlNqi1vDLQTcKL1X6tCvY_f3ns"/><meta name="baidu-site-verification" content="code-EWEBQNmKjY"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Mysql (二)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-19 15:50:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/pink.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Daisy's Blog"><span class="site-name">Daisy's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Mysql (二)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/mysql/">mysql</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Mysql (二)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h1><p>MySQL存储函数（自定义函数），函数一般用于计算和返回一个值，可以将经常需要使用的计算或功能写成一个函数。</p>
<p>存储函数和存储过程一样，都是在数据库中定义一些 SQL 语句的集合。</p>
<p>存储函数与存储过程的区别</p>
<ul>
<li>存储函数有且只有一个返回值，而存储过程可以有多个返回值，也可以没有返回值</li>
<li>存储函数只能有输入参数，而且不能带in, 而存储过程可以有多个in,out,inout参数</li>
<li>存储过程中的语句功能更强大，存储过程可以实现很复杂的业务逻辑，而函数有很多限制，如不能在函数中使用insert,update,delete,create等语句</li>
<li>存储函数只完成查询的工作，可接受输入参数并返回一个结果，也就是函数实现的功能针对性比较强</li>
<li>存储过程可以调用存储函数。但函数不能调用存储过程</li>
<li>存储过程一般是作为一个独立的部分来执行(call调用)。而函数可以作为查询语句的一个部分来调用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">create function func_name ([param_name type[,...]])</span><br><span class="line">returns type</span><br><span class="line">[characteristic ...] </span><br><span class="line">begin</span><br><span class="line">    routine_body</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">参数说明：</span><br><span class="line">（1）func_name ：存储函数的名称。</span><br><span class="line">（2）param_name type：可选项，指定存储函数的参数。type参数用于指定存储函数的参数类型，该类型可以是MySQL数据库中所有支持的类型。</span><br><span class="line">（3）RETURNS type：指定返回值的类型。</span><br><span class="line">（4）characteristic：可选项，指定存储函数的特性。</span><br><span class="line">（5）routine_body：SQL代码内容</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create database mydb9_function;</span><br><span class="line">-- 导入测试数据</span><br><span class="line">use mydb9_function;</span><br><span class="line">set global log_bin_trust_function_creators=TRUE; -- 信任子程序的创建者</span><br><span class="line"> </span><br><span class="line">-- 创建存储函数-没有输输入参数</span><br><span class="line">drop function if exists myfunc1_emp;</span><br><span class="line"> </span><br><span class="line">delimiter $$</span><br><span class="line">create function myfunc1_emp() returns int</span><br><span class="line">begin</span><br><span class="line">  declare cnt int default 0;</span><br><span class="line">    select count(*) into  cnt from emp;</span><br><span class="line">  return cnt;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line">-- 调用存储函数</span><br><span class="line">select myfunc1_emp();</span><br><span class="line"></span><br><span class="line">-- 创建存储过程-有输入参数</span><br><span class="line"> </span><br><span class="line">drop function if exists myfunc2_emp;</span><br><span class="line">delimiter $$</span><br><span class="line">create function myfunc2_emp(in_empno int) returns varchar(50)</span><br><span class="line">begin</span><br><span class="line">    declare out_name varchar(50);</span><br><span class="line">    select ename into out_name from emp where  empno = in_empno;</span><br><span class="line">    return out_name;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">select myfunc2_emp(1008);</span><br></pre></td></tr></table></figure>
<h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><p>触发器，就是一种特殊的存储过程。触发器和存储过程一样是一个能够完成特定功能、存储在数据库服务器上的SQL片段，但是触发器无需调用，当对数据库表中的数据执行DML操作时自动触发这个SQL片段的执行，无需手动条用</p>
<p>mysql中，只有执行insert,delete,update操作时才能触发触发器的执行</p>
<p>触发器的这种特性可以协助应用在数据库端确保数据的完整性 , 日志记录 , 数据校验等操作 。</p>
<p>使用别名 OLD 和 NEW 来引用触发器中发生变化的记录内容，这与其他的数据库是相似的。现在触发器还只支持行级触发，不支持语句级触发。</p>
<p><img src="../../../images/image-20230612164347819.png" alt="image-20230612164347819"></p>
<p>特性</p>
<ul>
<li>什么条件会触发：I、D、U</li>
<li>什么时候触发：在增删改前或者后</li>
<li>触发频率：针对每一行执行</li>
<li>触发器定义在表上，附着在表上</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">-- 创建只有一个执行语句的触发器</span><br><span class="line">create trigger 触发器名 before|after 触发事件</span><br><span class="line">on 表名 for each row </span><br><span class="line">执行语句;</span><br><span class="line"></span><br><span class="line">-- 创建有多个执行语句的触发器</span><br><span class="line">create trigger 触发器名 before|after  触发事件 </span><br><span class="line">on 表名 for each row</span><br><span class="line">begin</span><br><span class="line">     执行语句列表</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">-- 数据准备</span><br><span class="line">create database if not exists mydb10_trigger;</span><br><span class="line">use mydb10_trigger;</span><br><span class="line"> </span><br><span class="line">-- 用户表</span><br><span class="line">create table user(</span><br><span class="line">    uid int primary key ,</span><br><span class="line">    username varchar(50) not null,</span><br><span class="line">    password varchar(50) not null</span><br><span class="line">);</span><br><span class="line">-- 用户信息操作日志表</span><br><span class="line">create table user_logs(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    time timestamp,</span><br><span class="line">    log_text varchar(255)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 如果触发器存在，则先删除</span><br><span class="line">drop trigger if  exists trigger_test1;</span><br><span class="line"> </span><br><span class="line">-- 创建触发器trigger_test1</span><br><span class="line">create trigger trigger_test1</span><br><span class="line">after insert on user -- 触发时机：当添加user表数据时触发</span><br><span class="line">for each row</span><br><span class="line">insert into user_logs values(NULL,now(), &#x27;有新用户注册&#x27;);</span><br><span class="line"> </span><br><span class="line">-- 添加数据，触发器自动执行并添加日志代码</span><br><span class="line">insert into user values(1,&#x27;张三&#x27;,&#x27;123456&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 如果触发器trigger_test2存在，则先删除</span><br><span class="line">drop trigger if exists trigger_test2;</span><br><span class="line"></span><br><span class="line">-- 创建触发器trigger_test2</span><br><span class="line">delimiter $$</span><br><span class="line">create trigger trigger_test2</span><br><span class="line">after update on user  -- 触发时机：当修改user表数据时触发</span><br><span class="line">for each row -- 每一行</span><br><span class="line">begin</span><br><span class="line">insert into user_logs values(NULL,now(), &#x27;用户修改发生了修改&#x27;);</span><br><span class="line">end $$</span><br><span class="line"> </span><br><span class="line">delimiter ;</span><br><span class="line"> </span><br><span class="line">-- 添加数据，触发器自动执行并添加日志代码</span><br><span class="line">update user set password = &#x27;888888&#x27; where uid = 1;</span><br></pre></td></tr></table></figure>
<p>MySQL 中定义了 NEW 和 OLD，用来表示触发器的所在表中，触发了触发器的那一行数据，来引用触发器中发生变化的记录内容，具体地</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>触发器类型</strong></th>
<th><strong>触发器类型NEW  和 OLD的使用</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>INSERT  型触发器</td>
<td>NEW  表示将要或者已经新增的数据</td>
</tr>
<tr>
<td>UPDATE  型触发器</td>
<td>OLD  表示修改之前的数据  ,  NEW 表示将要或已经修改后的数据</td>
</tr>
<tr>
<td>DELETE  型触发器</td>
<td>OLD  表示将要或者已经删除的数据</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">NEW.columnName （columnName为相应数据表某一列名）</span><br><span class="line"></span><br><span class="line">create trigger trigger_test3 after insert</span><br><span class="line">on user for each row</span><br><span class="line">insert into user_logs values(NULL,now(),concat(&#x27;有新用户添加，信息为:&#x27;,NEW.uid,NEW.username,NEW.password));</span><br><span class="line"> </span><br><span class="line">-- 测试</span><br><span class="line">insert into user values(4,&#x27;赵六&#x27;,&#x27;123456&#x27;);</span><br><span class="line">-- 查看触发器</span><br><span class="line">show triggers;</span><br><span class="line"></span><br><span class="line">-- 删除触发器</span><br><span class="line">-- drop trigger [if exists] trigger_name </span><br><span class="line">drop trigger if exists trigger_test1;</span><br></pre></td></tr></table></figure>
<p>注意事项</p>
<ul>
<li>MYSQL中触发器中不能对本表进行 insert ,update ,delete 操作，以免递归循环触发</li>
<li>尽量少使用触发器，假设触发器触发每次执行1s，insert table 500条数据，那么就需要触发500次触发器，光是触发器执行的时间就花费了500s，而insert 500条数据一共是1s，那么这个insert的效率就非常低了。</li>
<li>触发器是针对每一行的；对增删改非常频繁的表上切记不要使用触发器，因为它会非常消耗资源。 </li>
</ul>
<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><p>索引是通过某种算法，构建出一个数据模型，用于快速找出在某个列中有一特定值的行，不使用索引，MySQL必须从第一条记录开始读完整个表，直到找出相关的行，表越大，查询数据所花费的时间就越多，如果表中查询的列有一个索引，MySQL能够快速到达一个位置去搜索数据文件，而不必查看所有数据，那么将会节省很大一部分时间。</p>
<p>索引类似一本书的目录，比如要查找’student’这个单词，可以先找到s开头的页然后向后查找，这个就类似索引。</p>
<p>索引是存储引擎用来快速查找记录的一种数据结构，</p>
<p>按照实现的方式类分，主要有Hash索引和B+Tree索引</p>
<blockquote>
<p>Hash 索引</p>
</blockquote>
<p><strong>优点：</strong>通过字段的值计算的hash值，定位数据非常快。 <strong>缺点：</strong>不能进行范围查找，因为散列表中的值是无序的，无法进行大小的比较。</p>
<p><img src="../../../images/image-20230612174411032.png" alt="image-20230612174411032"></p>
<blockquote>
<p>B+Tree索引</p>
</blockquote>
<p>二叉树</p>
<p><strong>特性：</strong>分为左子树、右子树和根节点，左子树比根节点值要小，右子树比根节点值要大 <strong>缺点：</strong>有可能产生不平衡 类似于链表的结构 。</p>
<p><img src="../../../images/image-20230613093420433.png" alt="image-20230613093420433"></p>
<p>平衡二叉树</p>
<p><strong>特点：</strong></p>
<ul>
<li>它的左子树和右子树都是平衡二叉树</li>
<li>左子树比中间小，右子树比中间值大</li>
<li>左子树和右子树的深度之差的绝对值不超过1</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>插入操作需要旋转</li>
<li>支持范围查询，但回旋查询效率较低，比如要查找大于8的，会回旋到父节点7、10。</li>
<li>如果存放几百条数据的情况下，树高度越高，查询效率会越慢</li>
</ul>
<p>BTREE树</p>
<p>目前大部分数据库系统及文件系统都采用B-Tree或其变种B+Tree作为索引结构，Btree结构可以有效的解决之前的相关算法遇到的问题。</p>
<p><img src="../../../images/image-20230613093556738.png" alt="image-20230613093556738"></p>
<p>B+ Trees</p>
<p><img src="../../../images/image-20230612174920720.png" alt=""></p>
<p>MyISAM引擎使用B+Tree作为索引结构，叶节点的data域存放的是数据记录的地址。</p>
<p><img src="../../../images/image-20230613093653894.png" alt="image-20230613093653894"></p>
<p>InnoDB的叶节点的data域存放的是数据，相比MyISAM效率要高一些，但是比较占硬盘内存大小。</p>
<p><img src="../../../images/image-20230613093723002.png" alt="image-20230613093723002"></p>
<p>按照功能划分，索引划为以下分类:</p>
<p><img src="../../../images/image-20230612174951919.png" alt="image-20230612174951919"></p>
<h2 id="单列索引"><a href="#单列索引" class="headerlink" title="单列索引"></a>单列索引</h2><p>一个索引只包含单个列，但一个表中可以有多个单列索引;</p>
<p>普通索引：MySQL中基本索引类型，没有什么限制，允许在定义索引的列中插入重复值和空值，纯粹为了查询数据更快一点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">create database mydb5;</span><br><span class="line">use mydb5;</span><br><span class="line"></span><br><span class="line">-- 方式1-创建表的时候直接指定</span><br><span class="line">create  table student(</span><br><span class="line">    sid int primary key,</span><br><span class="line">    card_id varchar(20),</span><br><span class="line">    name varchar(20),</span><br><span class="line">    gender varchar(20),</span><br><span class="line">    age int,</span><br><span class="line">    birth date, </span><br><span class="line">    phone_num varchar(20),</span><br><span class="line">    score double,</span><br><span class="line">    index index_name(name) -- 给name列创建索引</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 方式2-直接创建</span><br><span class="line">-- create index indexname on tablename(columnname); </span><br><span class="line">create index index_gender on student(gender); </span><br><span class="line"></span><br><span class="line">-- 方式3-修改表结构(添加索引)</span><br><span class="line">-- alter table tablename add index indexname(columnname)</span><br><span class="line">alter table student add index index_age(age);</span><br><span class="line"></span><br><span class="line">-- 1、查看数据库所有索引 </span><br><span class="line">-- select * from mysql.`innodb_index_stats` a where a.`database_name` = &#x27;数据库名’; </span><br><span class="line">select * from mysql.`innodb_index_stats` a where a.`database_name` = &#x27;mydb5&#x27;;</span><br><span class="line"></span><br><span class="line">-- 2、查看表中所有索引 </span><br><span class="line">-- select * from mysql.`innodb_index_stats` a where a.`database_name` = &#x27;数据库名&#x27; and a.table_name like &#x27;%表名%’;</span><br><span class="line">select * from mysql.`innodb_index_stats` a where a.`database_name` = &#x27;mydb5&#x27; and a.table_name like &#x27;%student%&#x27;;</span><br><span class="line"></span><br><span class="line">-- 3、查看表中所有索引 </span><br><span class="line">-- show index from table_name; </span><br><span class="line">show index from student;</span><br><span class="line"></span><br><span class="line">-- 删除索引</span><br><span class="line">drop index 索引名 on 表名 </span><br><span class="line">-- 或 </span><br><span class="line">alter table 表名 drop index 索引名 </span><br><span class="line"></span><br><span class="line">drop index index_gender on student </span><br><span class="line">alter table student drop index index_name</span><br></pre></td></tr></table></figure>
<p>唯一索引</p>
<p>唯一索引与前面的普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 方式1-创建表的时候直接指定</span><br><span class="line">create  table student2(</span><br><span class="line">    sid int primary key,</span><br><span class="line">    card_id varchar(20),</span><br><span class="line">    name varchar(20),</span><br><span class="line">    gender varchar(20),</span><br><span class="line">    age int,</span><br><span class="line">    birth date, </span><br><span class="line">    phone_num varchar(20),</span><br><span class="line">    score double,</span><br><span class="line">    unique index_card_id(card_id) -- 给card_id列创建索引</span><br><span class="line">);</span><br><span class="line">-- 方式2-直接创建</span><br><span class="line">-- create unique index 索引名 on 表名(列名) </span><br><span class="line">create unique index index_card_id on student2(card_id);</span><br><span class="line"></span><br><span class="line">-- 方式3-修改表结构(添加索引)</span><br><span class="line">-- alter table 表名 add unique [索引名] (列名)</span><br><span class="line">alter table student2 add unique index_phone_num(phone_num)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>主键索引</p>
<p>每张表一般都会有自己的主键，当我们在创建表时，MySQL会自动在主键列上建立一个索引，这就是主键索引。主键是具有唯一性并且不允许为NULL，所以他是一种特殊的唯一索引</p>
<h2 id="组合索引"><a href="#组合索引" class="headerlink" title="组合索引"></a>组合索引</h2><p>组合索引也叫复合索引，指的是我们在建立索引的时候使用多个字段，例如同时使用身份证和手机号建立索引，同样的可以建立为普通索引或者是唯一索引。</p>
<p>复合索引的使用复合最左原则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">-- 创建索引的基本语法 </span><br><span class="line">create index indexname on table_name(column1(length),column2(length)); </span><br><span class="line"></span><br><span class="line">-- 组合索引</span><br><span class="line">use mydb5;</span><br><span class="line">-- 创建索引的基本语法-- 普通索引</span><br><span class="line">-- create index indexname on table_name(column1(length),column2(length)); </span><br><span class="line">create index index_phone_name on student(phone_num,name);</span><br><span class="line">-- 操作-删除索引</span><br><span class="line"> drop index index_phone_name on student; </span><br><span class="line">-- 创建索引的基本语法-- 唯一索引</span><br><span class="line">create  unique index index_phone_name on student(phone_num,name); </span><br><span class="line"></span><br><span class="line">select * from student where name = &#x27;张三&#x27;; </span><br><span class="line">select * from student where phone_num = &#x27;15100046637&#x27;; </span><br><span class="line">select * from student where phone_num = &#x27;15100046637&#x27; and name = &#x27;张三&#x27;; </span><br><span class="line">select * from student where name = &#x27;张三&#x27; and phone_num = &#x27;15100046637&#x27;; </span><br><span class="line">/* </span><br><span class="line">  三条sql只有 2 、 3、4能使用的到索引idx_phone_name,因为条件里面必须包含索引前面的字段  才能够进行匹配。</span><br><span class="line">  而3和4相比where条件的顺序不一样，为什么4可以用到索引呢？是因为mysql本身就有一层sql优化，他会根据sql来识别出来该用哪个索引，我们可以理解为3和4在mysql眼中是等价的。 </span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<h2 id="全文索引"><a href="#全文索引" class="headerlink" title="全文索引"></a>全文索引</h2><p>全文索引的关键字是fulltext</p>
<p>全文索引主要用来查找文本中的关键字，而不是直接与索引中的值相比较，它更像是一个搜索引擎，基于相似度的查询，而不是简单的where语句的参数匹配。</p>
<p>用 like + % 就可以实现模糊匹配了，为什么还要全文索引？like + % 在文本比较少时是合适的，但是对于大量的文本数据检索，是不可想象的。全文索引在大量的数据面前，能比 like + % 快 N 倍，速度不是一个数量级，但是全文索引可能存在精度问题。</p>
<p>全文索引的版本、存储引擎、数据类型的支持情况：</p>
<ul>
<li>MySQL 5.6 以前的版本，只有 MyISAM 存储引擎支持全文索引；</li>
<li>MySQL 5.6 及以后的版本，MyISAM 和 InnoDB 存储引擎均支持全文索引;</li>
<li>只有字段的数据类型为 char、varchar、text 及其系列才可以建全文索引；</li>
<li>在数据量较大时候，现将数据放入一个没有全局索引的表中，然后再用create index创建fulltext索引，要比先为一张表建立fulltext然后再将数据写入的速度快很多；</li>
<li>测试或使用全文索引时，要先看一下自己的 MySQL 版本、存储引擎和数据类型是否支持全文索引。</li>
</ul>
<p>MySQL 中的全文索引，有两个变量，最小搜索长度和最大搜索长度，对于长度小于最小搜索长度和大于最大搜索长度的词语，都不会被索引。通俗点就是说，想对一个词语使用全文索引搜索，那么这个词语的长度必须在以上两个变量的区间内。这两个的默认值可以使用以下命令查看:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;%ft%&#x27;;</span><br></pre></td></tr></table></figure>
<p>参数解释:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>#</th>
<th>参数名称</th>
<th>默认值</th>
<th>最小值</th>
<th>最大值</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>ft_min_word_len</td>
<td>4</td>
<td>1</td>
<td>3600</td>
<td>MyISAM  引擎表全文索引包含的最小词长度</td>
</tr>
<tr>
<td>2</td>
<td>ft_query_expansion_limit</td>
<td>20</td>
<td>0</td>
<td>1000</td>
<td>MyISAM引擎表使用  with  query expansion 进行全文搜索的最大匹配数</td>
</tr>
<tr>
<td>3</td>
<td>innodb_ft_min_token_size</td>
<td>3</td>
<td>0</td>
<td>16</td>
<td>InnoDB  引擎表全文索引包含的最小词长度</td>
</tr>
<tr>
<td>4</td>
<td>innodb_ft_max_token_size</td>
<td>84</td>
<td>10</td>
<td>84</td>
<td>InnoDB  引擎表全文索引包含的最大词长度</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 创建表的时候添加全文索引</span><br><span class="line">create table t_article (</span><br><span class="line">     id int primary key auto_increment ,</span><br><span class="line">     title varchar(255) ,</span><br><span class="line">     content varchar(1000) ,</span><br><span class="line">     writing_date date -- , </span><br><span class="line">     -- fulltext (content) -- 创建全文检索</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into t_article values(null,&quot;Yesterday Once More&quot;,&quot;When I was young I listen to the radio&quot;,&#x27;2021-10-01&#x27;);</span><br><span class="line">insert into t_article values(null,&quot;Right Here Waiting&quot;,&quot;Oceans apart, day after day,and I slowly go insane&quot;,&#x27;2021-10-02&#x27;); </span><br><span class="line">insert into t_article values(null,&quot;My Heart Will Go On&quot;,&quot;every night in my dreams,i see you, i feel you&quot;,&#x27;2021-10-03&#x27;);</span><br><span class="line">insert into t_article values(null,&quot;Everything I Do&quot;,&quot;eLook into my eyes,You will see what you mean to me&quot;,&#x27;2021-10-04&#x27;);</span><br><span class="line">insert into t_article values(null,&quot;Called To Say I Love You&quot;,&quot;say love you no new year&#x27;s day, to celebrate&quot;,&#x27;2021-10-05&#x27;);</span><br><span class="line">insert into t_article values(null,&quot;Nothing&#x27;s Gonna Change My Love For You&quot;,&quot;if i had to live my life without you near me&quot;,&#x27;2021-10-06&#x27;);</span><br><span class="line">insert into t_article values(null,&quot;Everybody&quot;,&quot;We&#x27;re gonna bring the flavor show U how.&quot;,&#x27;2021-10-07&#x27;);</span><br><span class="line"></span><br><span class="line">-- 修改表结构添加全文索引</span><br><span class="line">alter table t_article add fulltext index_content(content)</span><br><span class="line"> </span><br><span class="line">-- 直接添加全文索引</span><br><span class="line">create fulltext index index_content on t_article(content);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>使用全文索引</p>
<p>和常用的模糊匹配使用 like + % 不同，全文索引有自己的语法格式，使用 match 和 against 关键字，格式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">match (col1,col2,...)  against(expr [search_modifier])</span><br><span class="line"></span><br><span class="line">select * from t_article where match(content) against(&#x27;yo’); -- 没有结果 单词数需要大于等于3 </span><br><span class="line">select * from t_article where match(content) against(&#x27;you&#x27;); -- 有结果</span><br></pre></td></tr></table></figure>
<h2 id="空间索引"><a href="#空间索引" class="headerlink" title="空间索引"></a>空间索引</h2><p>MySQL在5.7之后的版本支持了空间索引，而且支持OpenGIS几何数据模型</p>
<p>空间索引是对空间数据类型的字段建立的索引，MYSQL中的空间数据类型有4种，分别是GEOMETRY、POINT、LINESTRING、POLYGON。</p>
<p>MYSQL使用SPATIAL关键字进行扩展，使得能够用于创建正规索引类型的语法创建空间索引。</p>
<p>创建空间索引的列，必须将其声明为NOT NULL。</p>
<p>空间索引一般是用的比较少，了解即可。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>含义</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Geometry</td>
<td>空间数据</td>
<td>任何一种空间类型</td>
</tr>
<tr>
<td>Point</td>
<td>点</td>
<td>坐标值</td>
</tr>
<tr>
<td>LineString</td>
<td>线</td>
<td>有一系列点连接而成</td>
</tr>
<tr>
<td>Polygon</td>
<td>多边形</td>
<td>由多条线组成</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">create table shop_info (</span><br><span class="line">  id  int  primary key auto_increment comment &#x27;id&#x27;,</span><br><span class="line">  shop_name varchar(64) not null comment &#x27;门店名称&#x27;,</span><br><span class="line">  geom_point geometry not null comment &#x27;经纬度&#x27;,</span><br><span class="line">  spatial key geom_index(geom_point)</span><br><span class="line">);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">use itcast_shop;</span><br><span class="line"> </span><br><span class="line">-- 创建临时表</span><br><span class="line">create  temporary  table tmp_goods_cat</span><br><span class="line">as</span><br><span class="line">select t3.catid   as cat_id_l3,   -- 3级分类id</span><br><span class="line">       t3.catname as cat_name_l3, -- 3级分类名称</span><br><span class="line">       t2.catid   as cat_id_l2,   -- 2级分类id</span><br><span class="line">       t2.catname as cat_name_l2, -- 2级分类名称</span><br><span class="line">       t1.catid   as cat_id_l1,   -- 1级分类id</span><br><span class="line">       t1.catname as cat_name_l1  -- 1级分类名称</span><br><span class="line">from itcast_shop.itheima_goods_cats t3,</span><br><span class="line">     itcast_shop.itheima_goods_cats t2,</span><br><span class="line">     itcast_shop.itheima_goods_cats t1</span><br><span class="line">where t3.parentid = t2.catid</span><br><span class="line">  and t2.parentid = t1.catid</span><br><span class="line">  and t3.cat_level = 3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- -- 统计分析不同一级商品分类对应的总金额、总笔数</span><br><span class="line">select</span><br><span class="line">  &#x27;2019-09-05&#x27;,</span><br><span class="line">  t1.cat_name_l1 as goods_cat_l1,</span><br><span class="line">  sum(t3.payprice * t3.goodsnum) as total_money,</span><br><span class="line">  count(distinct t3.orderid) as total_cnt</span><br><span class="line">from</span><br><span class="line">  tmp_goods_cat t1</span><br><span class="line">left join itheima_goods t2</span><br><span class="line">  on t1.cat_id_l3 = t2.goodscatid</span><br><span class="line">left join itheima_order_goods t3</span><br><span class="line">  on t2.goodsid = t3.goodsid</span><br><span class="line">where</span><br><span class="line">  substring(t3.createtime, 1, 10) = &#x27;2019-09-05&#x27;</span><br><span class="line">group by</span><br><span class="line">  t1.cat_name_l1;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">-- 创建索引</span><br><span class="line">create unique index idx_goods_cat3 on tmp_goods_cat(cat_id_l3);</span><br><span class="line">create unique index idx_itheima_goods on itheima_goods(goodsid);    </span><br><span class="line">create index idx_itheima__order_goods on itheima_order_goods(goodsid);  </span><br><span class="line">-- 可以看到添加索引之后，查询速度明显提高了很多。</span><br></pre></td></tr></table></figure>
<p>索引的优点</p>
<ul>
<li>大大加快数据的查询速度</li>
<li>使用分组和排序进行数据查询时，可以显著减少查询时分组和排序的时间</li>
<li>创建唯一索引，能够保证数据库表中每一行数据的唯一性</li>
<li>在实现数据的参考完整性方面，可以加速表和表之间的连接</li>
</ul>
<p>索引的缺点</p>
<ul>
<li>创建索引和维护索引需要消耗时间，并且随着数据量的增加，时间也会增加</li>
<li>索引需要占据磁盘空间</li>
<li>对数据表中的数据进行增加，修改，删除时，索引也要动态的维护，降低了维护的速度</li>
</ul>
<p>创建索引的原则</p>
<ul>
<li>更新频繁的列不应设置索引</li>
<li>数据量小的表不要使用索引（毕竟总共2页的文档，还要目录吗？）</li>
<li>重复数据多的字段不应设为索引（比如性别，只有男和女，一般来说：重复的数据超过百分之15就不该建索引）</li>
<li>首先应该考虑对where 和 order by 涉及的列上建立索引</li>
</ul>
<p>一般来说，索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储的磁盘上。</p>
<p>这样的话，索引查找过程中就要产生磁盘I/O消耗，相对于内存存取，I/O存取的消耗要高几个数量级，所以评价一个数据结构作为索引的优劣最重要的指标就是在查找过程中磁盘I/O操作次数的渐进复杂度。</p>
<p>换句话说，索引的结构组织要尽量减少查找过程中磁盘I/O的存取次数</p>
<h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><p>数据库存储引擎是数据库底层软件组织，数据库管理系统（DBMS）使用数据引擎进行创建、查询、更新和删除数据。</p>
<p>不同的存储引擎提供不同的存储机制、索引技巧、锁定水平等功能。现在许多不同的数据库管理系统都支持多种不同的数据引擎。MySQL的核心就是存储引擎。</p>
<p>用户可以根据不同的需求为数据表选择不同的存储引擎</p>
<p>可以使用 SHOW ENGINES 命令 可以查看Mysql的所有执行引擎，默认的执行引擎是innoDB 支持事务，行级锁定和外键。</p>
<p>分类：</p>
<ul>
<li><strong>MyISAM</strong>:  Mysql 5.5之前的默认数据库引擎，最为常用。拥有较高的插入，查询速度，但不支持事务</li>
<li><strong>InnoDB</strong>: 事务型速记的首选引擎，支持ACID事务，支持行级锁定，MySQL5.5成为默认数据库引擎</li>
<li><strong>Memory</strong> : 所有数据置于内存的存储引擎，拥有极高的插入，更新和查询效率。但是会占用和数据量成正比的内存空间。并且其内容会在MYSQL重新启动是会丢失</li>
<li><strong>Archive</strong> : •非常适合存储大量的独立的，作为历史记录的数据。因为它们不经常被读取。Archive 拥有高效的插入速度，但其对查询的支持相对较差</li>
<li><strong>Federated</strong> : 将不同的 MySQL 服务器联合起来，逻辑上组成一个完整的数据库。非常适合分布式应用</li>
<li><strong>CSV</strong> ：逻辑上由逗号分割数据的存储引擎。它会在数据库子目录里为每个数据表创建一个 .csv 文件。这是一种普通文本文件，每个数据行占用一个文本行。CSV 存储引擎不支持索引。</li>
<li><strong>BlackHole</strong>： 黑洞引擎，写入的任何数据都会消失，一般用于记录 binlog 做复制的中继</li>
<li><strong>ERFORMANCE_SCHEMA</strong> : 存储引擎该引擎主要用于收集数据库服务器性能参数。</li>
<li><strong>Mrg_Myisam Merge</strong> : 存储引擎，是一组MyIsam的组合，也就是说，他将MyIsam引擎的多个表聚合起来，但是他的内部没有数据，真正的数据依然是MyIsam引擎的表中，但是可以直接进行查询、删除更新等操作。</li>
</ul>
<p><img src="../../../images/image-20230613094646775.png" alt="image-20230613094646775"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">-- 查询当前数据库支持的存储引擎：</span><br><span class="line">show engines;</span><br><span class="line"> </span><br><span class="line">-- 查看当前的默认存储引擎：</span><br><span class="line">show variables like ‘%storage_engine%’;</span><br><span class="line"></span><br><span class="line">-- 查看某个表用了什么引擎(在显示结果里参数engine后面的就表示该表当前用的存储引擎): </span><br><span class="line">show create table student; </span><br><span class="line"> </span><br><span class="line">-- 创建新表时指定存储引擎：</span><br><span class="line">create table(...) engine=MyISAM;</span><br><span class="line"> </span><br><span class="line">-- 修改数据库引擎</span><br><span class="line">alter table student engine = INNODB;</span><br><span class="line">alter table student engine = MyISAM;</span><br><span class="line"></span><br><span class="line">-- 修改MySQL默认存储引擎方法</span><br><span class="line">1. 关闭mysql服务 </span><br><span class="line">2. 找到mysql安装目录下的my.ini文件： </span><br><span class="line">3. 找到default-storage-engine=INNODB 改为目标引擎，</span><br><span class="line">   如：default-storage-engine=MYISAM </span><br><span class="line">4. 启动mysql服务</span><br></pre></td></tr></table></figure>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>在MySQL中的事务（Transaction）是由存储引擎实现的，在MySQL中，只有InnoDB存储引擎才支持事务。</p>
<p>事务处理可以用来维护数据库的完整性，保证成批的 SQL 语句要么全部执行，要么全部不执行。</p>
<p>事务用来管理 DDL、DML、DCL 操作，比如 insert,update,delete 语句，默认是自动提交的。</p>
<p>MySQL的事务操作主要有以下三种</p>
<ul>
<li>开启事务：Start Transaction<ul>
<li>任何一条DML语句(insert、update、delete)执行，标志事务的开启</li>
<li>命令：BEGIN 或 START TRANSACTION</li>
</ul>
</li>
<li>提交事务：Commit Transaction<ul>
<li>成功的结束，将所有的DML语句操作历史记录和底层硬盘数据来一次同步</li>
<li>命令：COMMIT</li>
</ul>
</li>
<li>回滚事务：Rollback Transaction<ul>
<li>失败的结束，将所有的DML语句操作历史记录全部清空</li>
<li>命令：ROLLBACK </li>
</ul>
</li>
</ul>
<p>之前的所有SQL操作其实也有事务，只是MySQL自动帮我们完成的，每执行一条SQL时MySQL就帮我们自动提交事务，因此如果想要手动控制事务，则必须关闭MySQL的事务自动提交。</p>
<p>在MySQL中直接用 SET 来改变 MySQL 的自动提交模式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">set autocommit=0 禁止自动提交 </span><br><span class="line">set autocommit=1 开启自动提交 </span><br><span class="line">create database if not exists mydb12_transcation;</span><br><span class="line">use mydb12_transcation;</span><br><span class="line">-- 创建账户表</span><br><span class="line">create table account(</span><br><span class="line">    id int primary key, -- 账户id</span><br><span class="line">    name varchar(20), -- 账户名</span><br><span class="line">    money double -- 金额</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">--  插入数据</span><br><span class="line">insert into account values(1,&#x27;zhangsan&#x27;,1000);</span><br><span class="line">insert into account values(2,&#x27;lisi&#x27;,1000);</span><br><span class="line"></span><br><span class="line">-- 设置MySQL的事务为手动提交(关闭自动提交)</span><br><span class="line">select @@autocommit;</span><br><span class="line">set autocommit = 0;</span><br><span class="line"> </span><br><span class="line">-- 模拟账户转账</span><br><span class="line">-- 开启事务 </span><br><span class="line">begin;</span><br><span class="line">update account set money = money - 200 where name = &#x27;zhangsan&#x27;;</span><br><span class="line">update account set money = money + 200 where name = &#x27;lisi&#x27;;</span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">-- 如果转账中的任何一条出现问题，则回滚事务</span><br><span class="line">rollback;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><p>ACID：Atomicity，Consistency，Isolation，Durability </p>
<p><img src="../../../images/image-20230613114954736.png" alt="image-20230613114954736"></p>
<h2 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h2><p>Mysql的默认隔离级别是Repeatable read。</p>
<p><img src="../../../images/image-20230613115234289.png" alt="image-20230613115234289"></p>
<ul>
<li>读未提交(Read uncommitted)<ul>
<li>一个事务可以读取另一个未提交事务的数据，最低级别，任何情况都无法保证,会造成脏读。</li>
<li>读取未提交的数据，也称为脏读(dirty read)</li>
</ul>
</li>
<li>读已提交(Read committed)<ul>
<li>一个事务要等另一个事务提交后才能读取数据，可避免脏读的发生，会造成不可重复读。</li>
<li>大多数数据库系统的默认隔离级别是READ COMMITTED（但MySQL不是）</li>
<li>不可重复读(nonrepeatable read)，这意味着同一事务中两次执行相同语句，可能会看到不同的数据结果。</li>
</ul>
</li>
<li>可重复读(Repeatable read)<ul>
<li>就是在开始读取数据（事务开启）时，不再允许修改操作，可避免脏读、不可重复读的发生，但是会造成幻读。</li>
<li>幻读，指的是当某个事务在读取某个范围内的记录时，另外一个事务又在该范围内插入了新的记录，当之前的事务再次读取该范围的记录时，会产生幻行(phantom row)</li>
<li>REPEATABLE READ是MySQL默认的事务隔离级别</li>
</ul>
</li>
<li>串行(Serializable)<ul>
<li>是最高的事务隔离级别，在该级别下，事务串行化顺序执行，可以避免脏读、不可重复读与幻读。但是这种事务隔离级别效率低下，比较耗数据库性能，一般不使用。</li>
</ul>
</li>
</ul>
<p><img src="../../../images/image-20230614111107049.png" alt="image-20230614111107049"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 查看隔离级别 </span><br><span class="line">show variables like &#x27;%isolation%&#x27;; </span><br><span class="line"></span><br><span class="line">-- 设置隔离级别</span><br><span class="line">/*</span><br><span class="line">set session transaction isolation level 级别字符串</span><br><span class="line">级别字符串：read uncommitted、read committed、repeatable read、serializable</span><br><span class="line">*/</span><br><span class="line">-- 设置read uncommitted</span><br><span class="line">set session transaction isolation level read uncommitted;</span><br><span class="line"> </span><br><span class="line">-- 设置read committed</span><br><span class="line">set session transaction isolation level read committed;</span><br><span class="line"> </span><br><span class="line">-- 设置repeatable read</span><br><span class="line">set session transaction isolation level repeatable read;</span><br><span class="line"> </span><br><span class="line">-- 设置serializable</span><br><span class="line">set session transaction isolation level serializable;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://starskydata.com">Daisy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://starskydata.com/posts/55410.html">http://starskydata.com/posts/55410.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql/">sql</a><a class="post-meta__tags" href="/tags/mysql/">mysql</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/18640.html" title="Mysql (三)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Mysql (三)</div></div></a></div><div class="next-post pull-right"><a href="/posts/42467.html" title="Data Analyst"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Data Analyst</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/19528.html" title="SQL 基础"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">SQL 基础</div></div></a></div><div><a href="/posts/53592.html" title="数据库系统"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">数据库系统</div></div></a></div><div><a href="/posts/6358.html" title="Mysql (一)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">Mysql (一)</div></div></a></div><div><a href="/posts/18640.html" title="Mysql (三)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">Mysql (三)</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Daisy</div><div class="author-info__description">分享计算机相关，旅行，美妆，一个平凡人的生活点滴</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text">存储函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">3.</span> <span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-number">3.1.</span> <span class="toc-text">单列索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">3.2.</span> <span class="toc-text">组合索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95"><span class="toc-number">3.3.</span> <span class="toc-text">全文索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95"><span class="toc-number">3.4.</span> <span class="toc-text">空间索引</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">4.</span> <span class="toc-text">存储引擎</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">5.1.</span> <span class="toc-text">特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">5.2.</span> <span class="toc-text">隔离级别</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/19528.html" title="SQL 基础">SQL 基础</a><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/53592.html" title="数据库系统">数据库系统</a><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/6358.html" title="Mysql (一)">Mysql (一)</a><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/18640.html" title="Mysql (三)">Mysql (三)</a><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/55410.html" title="Mysql (二)">Mysql (二)</a><time datetime="2023-07-17T12:20:53.000Z" title="Created 2023-07-17 16:20:53">2023-07-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/pink.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Daisy</div><div class="footer_custom_text">Hi, welcome to Daisy's blog.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'drak' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '86359bb4e81712c59c38',
      clientSecret: '513930a00de8718c7c1fab2fe09128ec5ef94042',
      repo: 'DaisyW92.github.io',
      owner: 'DaisyW92',
      admin: ['DaisyW92'],
      id: '889eec08aadc6fa078282c546657e9cb',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.textContent= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>